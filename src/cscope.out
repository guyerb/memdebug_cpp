cscope 15 $HOME/Development/dmalloc/src               0000005479
	@dmalloc_intercept.cpp

	@dmalloc_stats.cpp

1 
	~<c¡dio
>

2 
	~<io¡»am
>

3 
	~<¡ršg
>

4 
	~<c¡dšt
>

6 
	~"un™_‹¡.h
"

8 
usšg
 
	gÇme¥aû
::
¡d
;

11 #ifdeà
DMALLOC_UNIT_STATS


14 
	$maš
()

16 
un™_‹¡
 
ut
;

18 
ut
.
	`¡¬t_un™
("STATS");

20 
	}
}

	@dmalloc_stats.h

2 şas 
	cdm®l_¡©s
 {

3 
ušŒe_t
 
	myadayaga


	@dmalloc_unit_tests.h

1 #iâdeà
DMALLOC_UNIT_TESTS_H


2 
	#DMALLOC_UNIT_TESTS_H


	)

4 şas 
	cdm®loc_un™_‹¡
 {

6 
	m¡d
::
¡ršg
 
_un™_desü
 = {};

7 
ušt32_t
 
	g_tÙ®_‹¡
 = {0};

8 
ušt32_t
 
	g_tÙ®_sucûss
 = {0};

9 
ušt32_t
 
	g_tÙ®_ç
 = {0};

11 
	g¡d
::
¡ršg
 
_£ùiÚ_desü
 = {};

12 
ušt32_t
 
	g_£ùiÚ_‹¡
 = {0};

13 
ušt32_t
 
	g_£ùiÚ_sucûss
 {10};

14 
ušt32_t
 
	g_£ùiÚ_ç
 = {0};

16 
	gpublic
:

17 
dm®loc_un™_‹¡
() = ;

18 
	$dm®loc_un™_‹¡
(
¡d
::
¡ršg
 
desü
è: 
	$_un™_desü
(
desü
è{
	}
};

20 ~
	$dm®loc_un™_‹¡
(è{
	}
};

22 
dm®loc_¡¬t_un™
();

23 
dm®loc_fšish_un™
();

25 
	$dm®loc_¡¬t_£ùiÚ
(
¡d
::
¡ršg
 
desü
è{
_£ùiÚ_desü
 = desü;
	}
};

26 
dm®loc_fšish_£ùiÚ
();

30 
	gdm®loc_un™_‹¡
::
	$dm®loc_¡¬t_un™
()

32 
cout
 << 
_un™_desü
 << 
’dl
;

34 
	}
}

	@unit_test.h

1 #iâdeà
UNIT_TESTS_H


2 
	#UNIT_TESTS_H


	)

4 
	~<io¡»am
>

5 
	~<iomª
>

6 
	~<c¡dio
>

8 
usšg
 
	gÇme¥aû
::
¡d
;

10 şas 
	cun™_‹¡
 {

12 cÚ¡ 
	m¡d
::
¡ršg
 
_un™_´efix
 = "UNIT TEST: ";

13 
	m¡d
::
¡ršg
 
_un™_desü
 = {};

14 
ušt32_t
 
	g_un™_‹¡
 = {0};

15 
ušt32_t
 
	g_un™_·ss
 = {0};

16 
ušt32_t
 
	g_un™_ç
 = {0};

18 cÚ¡ 
	g¡d
::
¡ršg
 
_£ùn_´efix
 = "SECTION: ";

19 
	g¡d
::
¡ršg
 
_£ùn_desü
 = {};

20 
ušt32_t
 
	g_£ùn_‹¡
 = {0};

21 
ušt32_t
 
	g_£ùn_·ss
 = {0};

22 
ušt32_t
 
	g_£ùn_ç
 = {0};

24 
	gpublic
:

25 
un™_‹¡
() = ;

26 ~
	$un™_‹¡
(è{
	}
};

28 
ut_¡¬t_un™
(
¡d
::
¡ršg
 
desü
, 
d–im
='#');

29 
ut_fšish_un™
();

31 
ut_¡¬t_£ùiÚ
(
¡d
::
¡ršg
 
desü
, 
d–im
='*');

32 
ut_fšish_£ùiÚ
();

34 
ut_h—d”
(
¡d
::
¡ršg
 
´efix
, std::¡ršg 
desü
, 
d–im
);

36 
	g‹m¶©e
 <
şass
 
	gT
>

37 
ut_check
(
¡d
::
¡ršg
 
desü
, 
T
, T);

39 
	g‹m¶©e
 <
şass
 
	gT
>

40 
ut_check_Ã
(
¡d
::
¡ršg
 
desü
, 
T
, T);

44 
	g‹m¶©e
 <
şass
 
	gT
>

45 
	gun™_‹¡
::
	$ut_check
(
¡d
::
¡ršg
 
desü
, 
T
 
ex³ùed
, T 
aùu®
)

47 
boŞ
 
·s£d
 = (
ex³ùed
 =ğ
aùu®
);

49 
_un™_‹¡
++; 
_£ùn_‹¡
++;

50 ià(
·s£d
) {

51 
_£ùn_·ss
++; 
_un™_·ss
++;

53 
_£ùn_ç
++; 
_un™_ç
++;

55 
cout
 << 
	`£tw
(30è<< 
Ëá
 << 
desü
 << s‘w(8è<< (
·s£d
 ? "PASSED_" : "_FAILED"è<< s‘w(12è<< 
right
 << 
ex³ùed
 << s‘w(12è<<„ighˆ<< 
aùu®
 << 
’dl
;

56 
	}
}

58 
	g‹m¶©e
 <
şass
 
	gT
>

59 
	gun™_‹¡
::
	$ut_check_Ã
(
¡d
::
¡ršg
 
desü
, 
T
 
ex³ùed
, T 
aùu®
)

61 
boŞ
 
·s£d
 = (
ex³ùed
 !ğ
aùu®
);

63 
_un™_‹¡
++; 
_£ùn_‹¡
++;

64 ià(
·s£d
) {

65 
_£ùn_·ss
++; 
_un™_·ss
++;

67 
_£ùn_ç
++; 
_un™_ç
++;

69 
cout
 << 
	`£tw
(30è<< 
Ëá
 << 
desü
 << s‘w(8è<< (
·s£d
 ? "PASSED_" : "_FAILED"è<< s‘w(12è<< 
right
 << 
ex³ùed
 << s‘w(12è<<„ighˆ<< 
aùu®
 << 
’dl
;

70 
	}
}

72 
	gun™_‹¡
::
	$ut_h—d”
(
¡d
::
¡ršg
 
´efix
, std::¡ršg 
desü
, 
d–im
)

74 
ušt8_t
 
¡¾’
 = 
´efix
.
	`Ëngth
(è+ 
desü
.length();

76 
cout
 << 
	`£tfl
(
d–im
è<< 
	`£tw
(20è<< " " << 
´efix
 << 
desü
 << " " << s‘w(80 - 
¡¾’
 - 20è<< d–im << s‘fl(' 'è<< 
’dl
;

77 
	}
}

79 
	gun™_‹¡
::
	$ut_¡¬t_un™
(
¡d
::
¡ršg
 
desü
, 
d–im
)

81 
_un™_desü
 = 
desü
;

82 
	`ut_h—d”
(
_un™_´efix
, 
_un™_desü
, 
d–im
);

83 
	}
}

85 
	gun™_‹¡
::
	$ut_¡¬t_£ùiÚ
(
¡d
::
¡ršg
 
desü
, 
d–im
)

87 
_£ùn_desü
 = 
desü
;

88 
	`ut_h—d”
(
_£ùn_´efix
, 
_£ùn_desü
, 
d–im
);

89 
	}
}

91 
	gun™_‹¡
::
	$ut_fšish_un™
()

93 
cout
 << 
’dl
 << 
_un™_´efix
 << 
	`£tw
(30è<< 
Ëá
 << 
_un™_desü
 << "e¡ " << 
_un™_‹¡
 << "…as£d " << 
_un™_·ss
 << " faed " << 
_un™_ç
 <<ƒndl <<ƒndl;

94 
_un™_‹¡
 = 
_un™_·ss
 = 
_un™_ç
 = 0;

95 
	}
}

97 
	gun™_‹¡
::
	$ut_fšish_£ùiÚ
()

99 
cout
 << 
’dl
 << 
_£ùn_´efix
 << 
	`£tw
(30è<< 
Ëá
 << 
_£ùn_desü
 << "e¡ " << 
_£ùn_‹¡
 << "…as£d " << 
_£ùn_·ss
 << " faed " << 
_£ùn_ç
 <<ƒndl <<ƒndl;

100 
_£ùn_‹¡
 = 
_£ùn_·ss
 = 
_£ùn_ç
 = 0;

101 
	}
}

	@ut.cpp

1 
	~<c¡dio
>

2 
	~<io¡»am
>

3 
	~<¡ršg
>

4 
	~<c¡dšt
>

6 
	~"un™_‹¡.h
"

8 
usšg
 
	gÇme¥aû
::
¡d
;

11 
	$maš
()

13 
un™_‹¡
 
ut
;

14 
ušt32_t
 
i
 = 0;

15 
ušt64_t
 
j
 = 0;

17 
Ën1
 = 
ut
.
	`ut_¡¬t_un™
("unitest self check", '^');

18 
Ën2
 = 
ut
.
	`ut_¡¬t_£ùiÚ
("exercise ut_check method");

19 
ut
.
	`ut_check
("ut_check selfest int", 1, 1);

20 
ut
.
	`ut_check
("ut_check selfest int", 1, 0);

21 
ut
.
	`ut_check
("ut_check selfest int", 0, 1);

22 
ut
.
	`ut_check_Ã
("ut_check selfest != int", 0, 1);

23 
ut
.
	`ut_check_Ã
("ut_check selfest != int", 1, 0);

24 
ut
.
	`ut_check
("ut_check s–à‹¡ u32", 
i
, i);

25 
ut
.
	`ut_check
("ut_check s–à‹¡ u64", 
j
, j);

26 
ut
.
	`ut_check
("¡¬t_un™†’", 80, 
Ën1
);

27 
ut
.
	`ut_check
("¡¬t_£ùiÚ†’", 80, 
Ën2
);

28 
time_t
 
now
 = 
	`time
(
nuÎ±r
);

29 
ut
.
	`ut_check
("ut_check s–à‹¡m", 
now
,‚ow);

30 
ut
.
	`ut_check
("ut_check s–à‹¡m", 
now
,‚ow + 1);

31 
ut
.
	`ut_check_Ã
("ut_check s–à‹¡ !ğtm", 
now
,‚ow + 1);

32 
ut
.
	`ut_check
("ut_check selfest str", "a string", "a string");

33 
ut
.
	`ut_check
("ut_check selfest str", "a string", "b string");

34 
ut
.
	`ut_check_Ã
("ut_check selfest != str", "a string", "b string");

35 
ut
.
	`ut_fšish_£ùiÚ
();

36 
ut
.
	`ut_¡¬t_£ùiÚ
("zero stats section");

37 
ut
.
	`ut_fšish_£ùiÚ
();

38 
ut
.
	`ut_fšish_un™
();

46 
	}
}

	@
1
.
0
6
96
dmalloc_intercept.cpp
dmalloc_stats.cpp
dmalloc_stats.h
dmalloc_unit_tests.h
unit_test.h
ut.cpp
